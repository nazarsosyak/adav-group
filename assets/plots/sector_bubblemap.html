---
layout: null
---
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sector Bubblemap</title>
  <style>
    html, body {
        margin: 0;
        padding: 0;
        overflow: hidden;
      }
    #wrap { height: 100%; width: 100%; position: relative; }
    #chart { height: 640px; width: 100%; }

    .glass {
        position:absolute;
        inset: 14px;
        border-radius: 18px;
        background: rgba(255,255,255,.92); /* was .55 */
        border: 1px solid rgba(0,0,0,.08);
        backdrop-filter: none;              
        box-shadow: 0 6px 18px rgba(0,0,0,.08);
        pointer-events:none;
        z-index: 1;
      }


    #topbar {
      position:absolute; top: 18px; left: 22px; right: 22px;
      display:flex; align-items:center; justify-content:space-between;
      gap: 10px;
      z-index: 5;
    }

    #title {
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-weight: 800;
      font-size: 13px;
      letter-spacing: .2px;
      color: rgba(20,20,20,.85);
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(255,255,255,.70);
      border: 1px solid rgba(0,0,0,.06);
      max-width: 72%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #right { display:flex; gap: 10px; align-items:center; }

    #hint {
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size: 12px;
      color: rgba(20,20,20,.65);
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(255,255,255,.55);
      border: 1px solid rgba(0,0,0,.05);
    }

    #backBtn {
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.78);
      border-radius: 12px;
      padding: 8px 10px;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-weight: 800;
      font-size: 13px;
      cursor: pointer;
      color: rgba(20,20,20,.85);
      transition: transform .15s ease, background .2s ease;
      display:none;
      user-select: none;
    }
    #backBtn:hover { transform: translateY(-1px); background: rgba(255,255,255,.92); }
  </style>
</head>

<body>
  <div id="wrap">
    <div class="glass"></div>

    <div id="topbar">
      <div id="title">Sector bubblemap: click a sector</div>
      <div id="right">
        <div id="hint">Non-overlapping ¬∑ drilldown</div>
        <button id="backBtn" type="button">‚Üê Back</button>
      </div>
    </div>

    <div id="chart"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script>
  (function () {
    const el = document.getElementById("chart");
    const titleEl = document.getElementById("title");
    const backBtn = document.getElementById("backBtn");
    const chart = echarts.init(el, null, { renderer: "canvas" });
    window.addEventListener("resize", () => chart.resize());

    // -------------------------------------------------------
    // Hardcoded NASDAQ names per sector (added ~10 each)
    // Edit freely.
    // -------------------------------------------------------
    const DATA = [
      {
        key:"technology", name:"Technology", color:"#009b77",
        stocks:[
          {t:"MSFT", n:"Microsoft"},
          {t:"AAPL", n:"Apple"},
          {t:"NVDA", n:"NVIDIA"},
          {t:"AVGO", n:"Broadcom"},
          {t:"ADBE", n:"Adobe"},
          {t:"CSCO", n:"Cisco"},
          {t:"INTC", n:"Intel"},
          {t:"AMD",  n:"AMD"},
          {t:"ORCL", n:"Oracle"},
          {t:"CRM",  n:"Salesforce"},
          {t:"NOW",  n:"ServiceNow"},
          {t:"SNPS", n:"Synopsys"},
          {t:"CDNS", n:"Cadence"},
          {t:"ANET", n:"Arista Networks"},
          {t:"MU",   n:"Micron"},
          {t:"LRCX", n:"Lam Research"},
          {t:"KLAC", n:"KLA"},
          {t:"ADSK", n:"Autodesk"}
        ]
      },
      {
        key:"health_care", name:"Health Care", color:"#45b8ac",
        stocks:[
          {t:"AMGN", n:"Amgen"},
          {t:"GILD", n:"Gilead Sciences"},
          {t:"REGN", n:"Regeneron"},
          {t:"VRTX", n:"Vertex"},
          {t:"ISRG", n:"Intuitive Surgical"},
          {t:"ILMN", n:"Illumina"},
          {t:"BIIB", n:"Biogen"},
          {t:"MRNA", n:"Moderna"},
          {t:"DXCM", n:"Dexcom"},
          {t:"IDXX", n:"IDEXX Laboratories"},
          {t:"SGEN", n:"Seagen"},
          {t:"INCY", n:"Incyte"},
          {t:"ALGN", n:"Align Technology"},
          {t:"HOLX", n:"Hologic"},
          {t:"BMRN", n:"BioMarin"},
          {t:"EXAS", n:"Exact Sciences"},
          {t:"VEEV", n:"Veeva Systems"},
          {t:"UTHR", n:"United Therapeutics"}
        ]
      },
      {
        key:"consumer_discretionary", name:"Consumer Discretionary", color:"#ff6f61",
        stocks:[
          {t:"AMZN", n:"Amazon"},
          {t:"TSLA", n:"Tesla"},
          {t:"BKNG", n:"Booking Holdings"},
          {t:"MELI", n:"MercadoLibre"},
          {t:"NFLX", n:"Netflix"},
          {t:"EBAY", n:"eBay"},
          {t:"ROST", n:"Ross Stores"},
          {t:"ORLY", n:"O‚ÄôReilly Automotive"},
          {t:"ABNB", n:"Airbnb"},
          {t:"UBER", n:"Uber"},
          {t:"LYFT", n:"Lyft"},
          {t:"PDD",  n:"PDD"},
          {t:"JD",   n:"JD.com"},
          {t:"LULU", n:"Lululemon"},
          {t:"MAR",  n:"Marriott"},
          {t:"EXPE", n:"Expedia"},
          {t:"NKE",  n:"Nike"},
          {t:"ETSY", n:"Etsy"}
        ]
      },
      {
        key:"consumer_staples", name:"Consumer Staples", color:"#88b04b",
        stocks:[
          {t:"COST", n:"Costco"},
          {t:"PEP",  n:"PepsiCo"},
          {t:"MDLZ", n:"Mondelez"},
          {t:"KDP",  n:"Keurig Dr Pepper"},
          {t:"SBUX", n:"Starbucks"},
          {t:"MNST", n:"Monster Beverage"},
          {t:"KR",   n:"Kroger"},
          {t:"WBA",  n:"Walgreens Boots Alliance"},
          {t:"CHDN", n:"Churchill Downs"},
          {t:"CPB",  n:"Campbell Soup"},
          {t:"CAG",  n:"Conagra Brands"},
          {t:"SJM",  n:"J.M. Smucker"},
          {t:"HSY",  n:"Hershey"},
          {t:"TSN",  n:"Tyson Foods"},
          {t:"KHC",  n:"Kraft Heinz"},
          {t:"CLX",  n:"Clorox"},
          {t:"STZ",  n:"Constellation Brands"},
          {t:"BG",   n:"Bunge"}
        ]
      },
      {
        key:"finance", name:"Finance", color:"#92a8d1",
        stocks:[
          {t:"CME",  n:"CME Group"},
          {t:"COIN", n:"Coinbase"},
          {t:"IBKR", n:"Interactive Brokers"},
          {t:"HOOD", n:"Robinhood"},
          {t:"NDAQ", n:"Nasdaq, Inc."},
          {t:"PYPL", n:"PayPal"},
          {t:"TROW", n:"T. Rowe Price"},
          {t:"AFRM", n:"Affirm"},
          {t:"SCHW", n:"Charles Schwab"},
          {t:"BLK",  n:"BlackRock"},
          {t:"AXP",  n:"American Express"},
          {t:"MS",   n:"Morgan Stanley"},
          {t:"GS",   n:"Goldman Sachs"},
          {t:"JPM",  n:"JPMorgan Chase"},
          {t:"BAC",  n:"Bank of America"},
          {t:"C",    n:"Citigroup"},
          {t:"SPGI", n:"S&P Global"},
          {t:"MCO",  n:"Moody‚Äôs"}
        ]
      },
      {
        key:"industrials", name:"Industrials", color:"#955251",
        stocks:[
          {t:"HON",  n:"Honeywell"},
          {t:"LHX",  n:"L3Harris"},
          {t:"CSX",  n:"CSX"},
          {t:"FDX",  n:"FedEx"},
          {t:"FAST", n:"Fastenal"},
          {t:"ODFL", n:"Old Dominion Freight Line"},
          {t:"PAYX", n:"Paychex"},
          {t:"UAL",  n:"United Airlines"},
          {t:"RTX",  n:"RTX"},
          {t:"BA",   n:"Boeing"},
          {t:"CAT",  n:"Caterpillar"},
          {t:"DE",   n:"Deere"},
          {t:"GD",   n:"General Dynamics"},
          {t:"NOC",  n:"Northrop Grumman"},
          {t:"ETN",  n:"Eaton"},
          {t:"EMR",  n:"Emerson"},
          {t:"UPS",  n:"UPS"},
          {t:"CPRT", n:"Copart"}
        ]
      },
      {
        key:"energy", name:"Energy", color:"#f4b183",
        stocks:[
          {t:"CEG",  n:"Constellation Energy"},
          {t:"FANG", n:"Diamondback Energy"},
          {t:"BKR",  n:"Baker Hughes"},
          {t:"CHRD", n:"Chord Energy"},
          {t:"CIVI", n:"Civitas Resources"},
          {t:"EOG",  n:"EOG Resources"},
          {t:"OXY",  n:"Occidental Petroleum"},
          {t:"COP",  n:"ConocoPhillips"},
          {t:"XOM",  n:"Exxon Mobil"},
          {t:"CVX",  n:"Chevron"},
          {t:"SLB",  n:"Schlumberger"},
          {t:"HAL",  n:"Halliburton"},
          {t:"MPC",  n:"Marathon Petroleum"},
          {t:"VLO",  n:"Valero"},
          {t:"PSX",  n:"Phillips 66"},
          {t:"DVN",  n:"Devon Energy"},
          {t:"PXD",  n:"Pioneer Natural Resources"},
          {t:"KMI",  n:"Kinder Morgan"}
        ]
      },
      {
        key:"utilities", name:"Utilities", color:"#9b2335",
        stocks:[
          {t:"AEP", n:"American Electric Power"},
          {t:"EXC", n:"Exelon"},
          {t:"XEL", n:"Xcel Energy"},
          {t:"PCG", n:"PG&E"},
          {t:"WEC", n:"WEC Energy"},
          {t:"ES",  n:"Eversource"},
          {t:"NI",  n:"NiSource"},
          {t:"CMS", n:"CMS Energy"},
          {t:"DUK", n:"Duke Energy"},
          {t:"SO",  n:"Southern Company"},
          {t:"D",   n:"Dominion Energy"},
          {t:"ED",  n:"Con Edison"},
          {t:"PEG", n:"Public Service Enterprise Group"},
          {t:"EIX", n:"Edison International"},
          {t:"SRE", n:"Sempra"},
          {t:"PPL", n:"PPL"},
          {t:"FE",  n:"FirstEnergy"},
          {t:"ETR", n:"Entergy"}
        ]
      },
      {
        key:"telecommunications", name:"Telecom", color:"#5b5ea6",
        stocks:[
          {t:"TMUS", n:"T-Mobile US"},
          {t:"CMCSA", n:"Comcast"},
          {t:"CHTR", n:"Charter Communications"},
          {t:"IDCC", n:"InterDigital"},
          {t:"AMX",  n:"Am√©rica M√≥vil"},
          {t:"VZ",   n:"Verizon"},
          {t:"T",    n:"AT&T"},
          {t:"TEF",  n:"Telef√≥nica"},
          {t:"TU",   n:"Telus"},
          {t:"BCE",  n:"BCE"},
          {t:"VOD",  n:"Vodafone"},
          {t:"TLK",  n:"Telkom Indonesia"},
          {t:"NTES", n:"NetEase (comms-adj)"},
          {t:"SATS", n:"EchoStar"},
          {t:"LUMN", n:"Lumen"},
          {t:"VIAV", n:"Viavi"},
          {t:"COMM", n:"CommScope"},
          {t:"CALX", n:"Calix"}
        ]
      },
      {
        key:"real_estate", name:"Real Estate", color:"#dd4124",
        stocks:[
          {t:"AMT",  n:"American Tower"},
          {t:"EQIX", n:"Equinix"},
          {t:"DLR",  n:"Digital Realty"},
          {t:"VICI", n:"VICI Properties"},
          {t:"SUI",  n:"Sun Communities"},
          {t:"WY",   n:"Weyerhaeuser"},
          {t:"EXR",  n:"Extra Space Storage"},
          {t:"IRM",  n:"Iron Mountain"},
          {t:"PLD",  n:"Prologis"},
          {t:"PSA",  n:"Public Storage"},
          {t:"O",    n:"Realty Income"},
          {t:"SPG",  n:"Simon Property"},
          {t:"AVB",  n:"AvalonBay"},
          {t:"EQR",  n:"Equity Residential"},
          {t:"ARE",  n:"Alexandria Real Estate"},
          {t:"WELL", n:"Welltower"},
          {t:"VTR",  n:"Ventas"},
          {t:"KIM",  n:"Kimco Realty"}
        ]
      },
      {
        key:"basic_materials", name:"Basic Materials", color:"#6b5b95",
        stocks:[
          {t:"ALB",  n:"Albemarle"},
          {t:"CCJ",  n:"Cameco"},
          {t:"IFF",  n:"IFF"},
          {t:"CLF",  n:"Cleveland-Cliffs"},
          {t:"GOLD", n:"Barrick Gold"},
          {t:"NEM",  n:"Newmont"},
          {t:"FCX",  n:"Freeport-McMoRan"},
          {t:"RIO",  n:"Rio Tinto"},
          {t:"BHP",  n:"BHP"},
          {t:"VALE", n:"Vale"},
          {t:"APD",  n:"Air Products"},
          {t:"LIN",  n:"Linde"},
          {t:"ECL",  n:"Ecolab"},
          {t:"SHW",  n:"Sherwin-Williams"},
          {t:"DOW",  n:"Dow"},
          {t:"DD",   n:"DuPont"},
          {t:"NUE",  n:"Nucor"},
          {t:"STLD", n:"Steel Dynamics"}
        ]
      },
      {
        key:"miscellaneous", name:"Misc.", color:"#b565a7",
        stocks:[
          {t:"GOOG", n:"Alphabet (Class C)"},
          {t:"META", n:"Meta Platforms"},
          {t:"INTU", n:"Intuit"},
          {t:"PANW", n:"Palo Alto Networks"},
          {t:"CRWD", n:"CrowdStrike"},
          {t:"FTNT", n:"Fortinet"},
          {t:"SNOW", n:"Snowflake"},
          {t:"PLTR", n:"Palantir"},
          {t:"SHOP", n:"Shopify"},
          {t:"ASML", n:"ASML"},
          {t:"TSM",  n:"TSMC"},
          {t:"QCOM", n:"Qualcomm"},
          {t:"TXN",  n:"Texas Instruments"},
          {t:"INTC", n:"Intel"},
          {t:"AMAT", n:"Applied Materials"},
          {t:"ADI",  n:"Analog Devices"},
          {t:"MCHP", n:"Microchip"},
          {t:"PYPL", n:"PayPal"}
        ]
      }
    ];

    // -------------------------------------------------------
    // packing helpers
    // -------------------------------------------------------
    function scaleSizes(values, minR, maxR) {
      const v = values.slice().filter(Number.isFinite);
      const lo = Math.min(...v), hi = Math.max(...v);
      return values.map(x => {
        if (!Number.isFinite(x) || hi === lo) return (minR + maxR) / 2;
        const t = (x - lo) / (hi - lo);
        const u = Math.pow(t, 0.6);
        return minR + u * (maxR - minR);
      });
    }

    function packCircles(radii) {
      const placed = [];

      function collides(x,y,r) {
        for (const p of placed) {
          const dx = x - p.x, dy = y - p.y;
          const rr = r + p.r + 8; // padding
          if (dx*dx + dy*dy < rr*rr) return true;
        }
        return false;
      }

      const order = radii.map((r,i)=>({r,i})).sort((a,b)=>b.r-a.r);

      for (const it of order) {
        const r = it.r;
        let a = 0;
        let ok = false;

        for (let k=0; k<9000; k++) {
          a += 0.33;
          const rad = 2.25 * a;
          const x = rad * Math.cos(a);
          const y = rad * Math.sin(a);
          if (!collides(x,y,r)) {
            placed.push({x,y,r,i:it.i});
            ok = true;
            break;
          }
        }
        if (!ok) placed.push({x: 260 + it.i*14, y: 0, r, i: it.i});
      }

      const out = Array(radii.length);
      for (const p of placed) out[p.i] = [p.x, p.y];
      return out;
    }

    function normalize(points, targetX=130, targetY=90) {
      let minX=Infinity,maxX=-Infinity,minY=Infinity,maxY=-Infinity;
      for (const [x,y] of points) { minX=Math.min(minX,x); maxX=Math.max(maxX,x); minY=Math.min(minY,y); maxY=Math.max(maxY,y); }
      const w = Math.max(1e-9, maxX-minX), h = Math.max(1e-9, maxY-minY);
      const s = Math.min((2*targetX)/w, (2*targetY)/h);
      const cx = (minX+maxX)/2, cy = (minY+maxY)/2;
      return points.map(([x,y]) => [(x-cx)*s, (y-cy)*s]);
    }

    const LABEL_BG = "rgba(255,255,255,.82)";
    const LABEL_BORDER = "rgba(0,0,0,.14)";

    // -------------------------------------------------------
    // Render: sectors
    // -------------------------------------------------------
    function renderSectors() {
      titleEl.textContent = "Sector bubblemap ‚Äî click a sector";
      backBtn.style.display = "none";

      const weights = DATA.map(s => s.stocks.length);
      const radii = scaleSizes(weights, 48, 110);
      const pts = normalize(packCircles(radii), 140, 95);

      const seriesData = DATA.map((s,i) => ({
        name: s.name,
        value: [pts[i][0], pts[i][1], weights[i]],
        symbolSize: radii[i],
        itemStyle: { color: s.color, opacity: 0.92 },
        sectorKey: s.key
      }));

      chart.setOption({
        backgroundColor: "transparent",
        animation: true,
        animationDuration: 850,
        animationEasing: "cubicOut",
        xAxis: { show:false, min:-170, max:170 },
        yAxis: { show:false, min:-125, max:125 },
        tooltip: {
          backgroundColor: "rgba(255,255,255,.95)",
          borderColor: "rgba(0,0,0,.10)",
          borderWidth: 1,
          formatter: (p) => {
            const s = DATA.find(x => x.name === p.name);
            const top = (s?.stocks || []).slice(0,5).map(x => x.t).join(", ");
            return `
              <div style="font-family:Inter,system-ui; font-weight:900; margin-bottom:4px;">${p.name}</div>
              <div style="font-family:Inter,system-ui; font-size:12px; color:rgba(20,20,20,.75)">
                Examples: <b>${top || ":"}</b><br/>Click to drill down
              </div>
            `;
          }
        },
        series: [{
          type: "scatter",
          data: seriesData,
          symbol: "circle",
          emphasis: {
            scale: true,
            focus: "self",
            // NO halo/shadow that hides labels
            itemStyle: { shadowBlur: 0 }
          },
          label: {
            show: true,
            formatter: (p) => p.name,
            fontFamily: "Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",
            fontWeight: 900,
            fontSize: 12,
            color: "rgba(20,20,20,.92)",
            backgroundColor: LABEL_BG,
            borderColor: LABEL_BORDER,
            borderWidth: 1,
            borderRadius: 8,
            padding: [4, 6, 4, 6]
          },
          labelLayout: { hideOverlap: true }
        }]
      }, true);
    }

    // -------------------------------------------------------
    // Render: stocks
    // -------------------------------------------------------
    function renderStocks(sectorKey) {
      const s = DATA.find(x => x.key === sectorKey);
      if (!s) return;

      titleEl.textContent = `${s.name}: largest NASDAQ names`;
      backBtn.style.display = "inline-block";

      const weights = s.stocks.map((_,i)=> (s.stocks.length - i)); // bigger = earlier
      const radii = scaleSizes(weights, 18, 62);
      const pts = normalize(packCircles(radii), 150, 105);

      const seriesData = s.stocks.map((x,i) => ({
        name: x.t,
        value: [pts[i][0], pts[i][1], weights[i]],
        symbolSize: radii[i],
        itemStyle: { color: s.color, opacity: 0.92 },
        company: x.n
      }));

      chart.setOption({
        backgroundColor: "transparent",
        animation: true,
        animationDuration: 700,
        animationEasing: "cubicOut",
        xAxis: { show:false, min:-190, max:190 },
        yAxis: { show:false, min:-140, max:140 },
        tooltip: {
          backgroundColor: "rgba(255,255,255,.95)",
          borderColor: "rgba(0,0,0,.10)",
          borderWidth: 1,
          formatter: (p) => {
            const c = p.data?.company || "";
            return `
              <div style="font-family:Inter,system-ui; font-weight:900;">${p.name}</div>
              <div style="font-family:Inter,system-ui; font-size:12px; color:rgba(20,20,20,.75)">
                ${c}
              </div>
            `;
          }
        },
        series: [{
        type: "scatter",
        data: seriesData,
        symbol: "circle",
      
        // üî• make bubbles solid + no haze
        itemStyle: {
          opacity: 1,
          shadowBlur: 0,
          shadowColor: "transparent",
          borderWidth: 1,
          borderColor: "rgba(0,0,0,.18)"
        },
      
        emphasis: {
          scale: true,
          focus: "self",
          itemStyle: {
            shadowBlur: 0,
            shadowColor: "transparent",
            borderWidth: 2,
            borderColor: "rgba(0,0,0,.28)"
          }
        },
      
        // üî• make labels readable
        label: {
          show: true,
          color: "#111",
          fontWeight: 900,
          backgroundColor: "rgba(255,255,255,.95)",
          borderColor: "rgba(0,0,0,.20)",
          borderWidth: 1,
          borderRadius: 8,
          padding: [4, 6]
        },
        labelLayout: { hideOverlap: true }
      }]
      }, true);
    }

    // interactions
    backBtn.addEventListener("click", () => renderSectors());

    chart.off("click");
    chart.on("click", (params) => {
      const k = params?.data?.sectorKey;
      if (k) renderStocks(k);
    });

    renderSectors();
  })();
  </script>
</body>
</html>

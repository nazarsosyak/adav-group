---
layout: null
---
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sector Bubblemap</title>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: transparent;
    }
    #chart { width: 100%; height: 100vh; }

    #backBtn{
      position:absolute; top:12px; left:12px;
      z-index: 10;
      display:none;
      border: 1px solid rgba(0,0,0,.15);
      background: rgba(255,255,255,.92);
      border-radius: 10px;
      padding: 8px 10px;
      cursor: pointer;
      font: 800 13px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: rgba(0,0,0,.85);
    }
    #backBtn:hover { background: rgba(255,255,255,1); }
  </style>
</head>

<body>
  <button id="backBtn" type="button">← Back</button>
  <div id="chart"></div>

  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script>
  (function () {
    const el = document.getElementById("chart");
    const backBtn = document.getElementById("backBtn");
    const chart = echarts.init(el, null, { renderer: "canvas" });
    window.addEventListener("resize", () => chart.resize());

    const DATA = [
      {
        key:"technology", name:"Technology", color:"#009b77",
        stocks:[
          {t:"MSFT", n:"Microsoft"},{t:"AAPL", n:"Apple"},{t:"NVDA", n:"NVIDIA"},{t:"AVGO", n:"Broadcom"},
          {t:"ADBE", n:"Adobe"},{t:"CSCO", n:"Cisco"},{t:"INTC", n:"Intel"},{t:"AMD", n:"AMD"},
          {t:"ORCL", n:"Oracle"},{t:"CRM", n:"Salesforce"},{t:"NOW", n:"ServiceNow"},{t:"SNPS", n:"Synopsys"},
          {t:"CDNS", n:"Cadence"},{t:"ANET", n:"Arista Networks"},{t:"MU", n:"Micron"},{t:"LRCX", n:"Lam Research"},
          {t:"KLAC", n:"KLA"},{t:"ADSK", n:"Autodesk"}
        ]
      },
      {
        key:"health_care", name:"Health Care", color:"#45b8ac",
        stocks:[
          {t:"AMGN", n:"Amgen"},{t:"GILD", n:"Gilead Sciences"},{t:"REGN", n:"Regeneron"},{t:"VRTX", n:"Vertex"},
          {t:"ISRG", n:"Intuitive Surgical"},{t:"ILMN", n:"Illumina"},{t:"BIIB", n:"Biogen"},{t:"MRNA", n:"Moderna"},
          {t:"DXCM", n:"Dexcom"},{t:"IDXX", n:"IDEXX Laboratories"},{t:"SGEN", n:"Seagen"},{t:"INCY", n:"Incyte"},
          {t:"ALGN", n:"Align Technology"},{t:"HOLX", n:"Hologic"},{t:"BMRN", n:"BioMarin"},{t:"EXAS", n:"Exact Sciences"},
          {t:"VEEV", n:"Veeva Systems"},{t:"UTHR", n:"United Therapeutics"}
        ]
      },
      {
        key:"consumer_discretionary", name:"Consumer Discretionary", color:"#ff6f61",
        stocks:[
          {t:"AMZN", n:"Amazon"},{t:"TSLA", n:"Tesla"},{t:"BKNG", n:"Booking Holdings"},{t:"MELI", n:"MercadoLibre"},
          {t:"NFLX", n:"Netflix"},{t:"EBAY", n:"eBay"},{t:"ROST", n:"Ross Stores"},{t:"ORLY", n:"O’Reilly Automotive"},
          {t:"ABNB", n:"Airbnb"},{t:"UBER", n:"Uber"},{t:"LYFT", n:"Lyft"},{t:"PDD", n:"PDD"},
          {t:"JD", n:"JD.com"},{t:"LULU", n:"Lululemon"},{t:"MAR", n:"Marriott"},{t:"EXPE", n:"Expedia"},
          {t:"NKE", n:"Nike"},{t:"ETSY", n:"Etsy"}
        ]
      },
      {
        key:"consumer_staples", name:"Consumer Staples", color:"#88b04b",
        stocks:[
          {t:"COST", n:"Costco"},{t:"PEP", n:"PepsiCo"},{t:"MDLZ", n:"Mondelez"},{t:"KDP", n:"Keurig Dr Pepper"},
          {t:"SBUX", n:"Starbucks"},{t:"MNST", n:"Monster Beverage"},{t:"KR", n:"Kroger"},{t:"WBA", n:"Walgreens Boots Alliance"},
          {t:"CHDN", n:"Churchill Downs"},{t:"CPB", n:"Campbell Soup"},{t:"CAG", n:"Conagra Brands"},{t:"SJM", n:"J.M. Smucker"},
          {t:"HSY", n:"Hershey"},{t:"TSN", n:"Tyson Foods"},{t:"KHC", n:"Kraft Heinz"},{t:"CLX", n:"Clorox"},
          {t:"STZ", n:"Constellation Brands"},{t:"BG", n:"Bunge"}
        ]
      },
      {
        key:"finance", name:"Finance", color:"#92a8d1",
        stocks:[
          {t:"CME", n:"CME Group"},{t:"COIN", n:"Coinbase"},{t:"IBKR", n:"Interactive Brokers"},{t:"HOOD", n:"Robinhood"},
          {t:"NDAQ", n:"Nasdaq, Inc."},{t:"PYPL", n:"PayPal"},{t:"TROW", n:"T. Rowe Price"},{t:"AFRM", n:"Affirm"},
          {t:"SCHW", n:"Charles Schwab"},{t:"BLK", n:"BlackRock"},{t:"AXP", n:"American Express"},{t:"MS", n:"Morgan Stanley"},
          {t:"GS", n:"Goldman Sachs"},{t:"JPM", n:"JPMorgan Chase"},{t:"BAC", n:"Bank of America"},{t:"C", n:"Citigroup"},
          {t:"SPGI", n:"S&P Global"},{t:"MCO", n:"Moody’s"}
        ]
      },
      {
        key:"industrials", name:"Industrials", color:"#955251",
        stocks:[
          {t:"HON", n:"Honeywell"},{t:"LHX", n:"L3Harris"},{t:"CSX", n:"CSX"},{t:"FDX", n:"FedEx"},
          {t:"FAST", n:"Fastenal"},{t:"ODFL", n:"Old Dominion Freight Line"},{t:"PAYX", n:"Paychex"},{t:"UAL", n:"United Airlines"},
          {t:"RTX", n:"RTX"},{t:"BA", n:"Boeing"},{t:"CAT", n:"Caterpillar"},{t:"DE", n:"Deere"},
          {t:"GD", n:"General Dynamics"},{t:"NOC", n:"Northrop Grumman"},{t:"ETN", n:"Eaton"},{t:"EMR", n:"Emerson"},
          {t:"UPS", n:"UPS"},{t:"CPRT", n:"Copart"}
        ]
      },
      {
        key:"energy", name:"Energy", color:"#f4b183",
        stocks:[
          {t:"CEG", n:"Constellation Energy"},{t:"FANG", n:"Diamondback Energy"},{t:"BKR", n:"Baker Hughes"},{t:"CHRD", n:"Chord Energy"},
          {t:"CIVI", n:"Civitas Resources"},{t:"EOG", n:"EOG Resources"},{t:"OXY", n:"Occidental Petroleum"},{t:"COP", n:"ConocoPhillips"},
          {t:"XOM", n:"Exxon Mobil"},{t:"CVX", n:"Chevron"},{t:"SLB", n:"Schlumberger"},{t:"HAL", n:"Halliburton"},
          {t:"MPC", n:"Marathon Petroleum"},{t:"VLO", n:"Valero"},{t:"PSX", n:"Phillips 66"},{t:"DVN", n:"Devon Energy"},
          {t:"PXD", n:"Pioneer Natural Resources"},{t:"KMI", n:"Kinder Morgan"}
        ]
      },
      {
        key:"utilities", name:"Utilities", color:"#9b2335",
        stocks:[
          {t:"AEP", n:"American Electric Power"},{t:"EXC", n:"Exelon"},{t:"XEL", n:"Xcel Energy"},{t:"PCG", n:"PG&E"},
          {t:"WEC", n:"WEC Energy"},{t:"ES", n:"Eversource"},{t:"NI", n:"NiSource"},{t:"CMS", n:"CMS Energy"},
          {t:"DUK", n:"Duke Energy"},{t:"SO", n:"Southern Company"},{t:"D", n:"Dominion Energy"},{t:"ED", n:"Con Edison"},
          {t:"PEG", n:"Public Service Enterprise Group"},{t:"EIX", n:"Edison International"},{t:"SRE", n:"Sempra"},{t:"PPL", n:"PPL"},
          {t:"FE", n:"FirstEnergy"},{t:"ETR", n:"Entergy"}
        ]
      },
      {
        key:"telecommunications", name:"Telecom", color:"#5b5ea6",
        stocks:[
          {t:"TMUS", n:"T-Mobile US"},{t:"CMCSA", n:"Comcast"},{t:"CHTR", n:"Charter Communications"},{t:"IDCC", n:"InterDigital"},
          {t:"AMX", n:"América Móvil"},{t:"VZ", n:"Verizon"},{t:"T", n:"AT&T"},{t:"TEF", n:"Telefónica"},
          {t:"TU", n:"Telus"},{t:"BCE", n:"BCE"},{t:"VOD", n:"Vodafone"},{t:"TLK", n:"Telkom Indonesia"},
          {t:"NTES", n:"NetEase (comms-adj)"},{t:"SATS", n:"EchoStar"},{t:"LUMN", n:"Lumen"},{t:"VIAV", n:"Viavi"},
          {t:"COMM", n:"CommScope"},{t:"CALX", n:"Calix"}
        ]
      },
      {
        key:"real_estate", name:"Real Estate", color:"#dd4124",
        stocks:[
          {t:"AMT", n:"American Tower"},{t:"EQIX", n:"Equinix"},{t:"DLR", n:"Digital Realty"},{t:"VICI", n:"VICI Properties"},
          {t:"SUI", n:"Sun Communities"},{t:"WY", n:"Weyerhaeuser"},{t:"EXR", n:"Extra Space Storage"},{t:"IRM", n:"Iron Mountain"},
          {t:"PLD", n:"Prologis"},{t:"PSA", n:"Public Storage"},{t:"O", n:"Realty Income"},{t:"SPG", n:"Simon Property"},
          {t:"AVB", n:"AvalonBay"},{t:"EQR", n:"Equity Residential"},{t:"ARE", n:"Alexandria Real Estate"},{t:"WELL", n:"Welltower"},
          {t:"VTR", n:"Ventas"},{t:"KIM", n:"Kimco Realty"}
        ]
      },
      {
        key:"basic_materials", name:"Basic Materials", color:"#6b5b95",
        stocks:[
          {t:"ALB", n:"Albemarle"},{t:"CCJ", n:"Cameco"},{t:"IFF", n:"IFF"},{t:"CLF", n:"Cleveland-Cliffs"},
          {t:"GOLD", n:"Barrick Gold"},{t:"NEM", n:"Newmont"},{t:"FCX", n:"Freeport-McMoRan"},{t:"RIO", n:"Rio Tinto"},
          {t:"BHP", n:"BHP"},{t:"VALE", n:"Vale"},{t:"APD", n:"Air Products"},{t:"LIN", n:"Linde"},
          {t:"ECL", n:"Ecolab"},{t:"SHW", n:"Sherwin-Williams"},{t:"DOW", n:"Dow"},{t:"DD", n:"DuPont"},
          {t:"NUE", n:"Nucor"},{t:"STLD", n:"Steel Dynamics"}
        ]
      },
      {
        key:"miscellaneous", name:"Misc.", color:"#b565a7",
        stocks:[
          {t:"GOOG", n:"Alphabet (Class C)"},{t:"META", n:"Meta Platforms"},{t:"INTU", n:"Intuit"},{t:"PANW", n:"Palo Alto Networks"},
          {t:"CRWD", n:"CrowdStrike"},{t:"FTNT", n:"Fortinet"},{t:"SNOW", n:"Snowflake"},{t:"PLTR", n:"Palantir"},
          {t:"SHOP", n:"Shopify"},{t:"ASML", n:"ASML"},{t:"TSM", n:"TSMC"},{t:"QCOM", n:"Qualcomm"},
          {t:"TXN", n:"Texas Instruments"},{t:"INTC", n:"Intel"},{t:"AMAT", n:"Applied Materials"},{t:"ADI", n:"Analog Devices"},
          {t:"MCHP", n:"Microchip"},{t:"PYPL", n:"PayPal"}
        ]
      }
    ];

    function scaleSizes(values, minR, maxR) {
      const v = values.filter(Number.isFinite);
      const lo = Math.min(...v), hi = Math.max(...v);
      return values.map(x => {
        if (!Number.isFinite(x) || hi === lo) return (minR + maxR) / 2;
        const t = (x - lo) / (hi - lo);
        return minR + Math.pow(t, 0.6) * (maxR - minR);
      });
    }

    function packCircles(radii) {
      const placed = [];
      function collides(x,y,r) {
        for (const p of placed) {
          const dx=x-p.x, dy=y-p.y;
          const rr=r+p.r+10;
          if (dx*dx + dy*dy < rr*rr) return true;
        }
        return false;
      }
      const order = radii.map((r,i)=>({r,i})).sort((a,b)=>b.r-a.r);
      for (const it of order) {
        const r = it.r;
        let a = 0, ok = false;
        for (let k=0; k<10000; k++) {
          a += 0.33;
          const rad = 2.25 * a;
          const x = rad * Math.cos(a);
          const y = rad * Math.sin(a);
          if (!collides(x,y,r)) { placed.push({x,y,r,i:it.i}); ok=true; break; }
        }
        if (!ok) placed.push({x: 260 + it.i*14, y: 0, r, i: it.i});
      }
      const out = Array(radii.length);
      for (const p of placed) out[p.i] = [p.x, p.y];
      return out;
    }

    function normalize(points, targetX=150, targetY=105) {
      let minX=Infinity,maxX=-Infinity,minY=Infinity,maxY=-Infinity;
      for (const [x,y] of points) { minX=Math.min(minX,x); maxX=Math.max(maxX,x); minY=Math.min(minY,y); maxY=Math.max(maxY,y); }
      const w = Math.max(1e-9, maxX-minX), h = Math.max(1e-9, maxY-minY);
      const s = Math.min((2*targetX)/w, (2*targetY)/h);
      const cx=(minX+maxX)/2, cy=(minY+maxY)/2;
      return points.map(([x,y]) => [(x-cx)*s, (y-cy)*s]);
    }

    const LABEL = {
      show: true,
      fontFamily: "system-ui, -apple-system, Segoe UI, Roboto, Arial",
      fontWeight: 800,
      fontSize: 12,
      color: "#111",
      textBorderColor: "rgba(255,255,255,.95)",
      textBorderWidth: 4
    };

    function baseOption() {
      return {
        backgroundColor: "transparent",
        animation: true,
        animationDuration: 650,
        animationEasing: "cubicOut",
        xAxis: { show:false, min:-210, max:210 },
        yAxis: { show:false, min:-160, max:160 },
        tooltip: { show: false }
      };
    }

    function renderSectors() {
      backBtn.style.display = "none";

      const weights = DATA.map(s => s.stocks.length);
      const radii = scaleSizes(weights, 56, 120);
      const pts = normalize(packCircles(radii), 150, 105);

      const seriesData = DATA.map((s,i) => ({
        name: s.name,
        value: [pts[i][0], pts[i][1], weights[i]],
        symbolSize: radii[i],
        sectorKey: s.key,
        itemStyle: {
          color: s.color,
          opacity: 1,
          borderWidth: 1.2,
          borderColor: "rgba(0,0,0,.18)",
          shadowBlur: 0
        }
      }));

      chart.setOption({
        ...baseOption(),
        series: [{
          type: "scatter",
          symbol: "circle",
          data: seriesData,
          label: { ...LABEL },
          labelLayout: { hideOverlap: true },
          emphasis: {
            scale: true,
            focus: "self",
            itemStyle: { borderWidth: 2, borderColor: "rgba(0,0,0,.28)", shadowBlur: 0 }
          }
        }]
      }, true);
    }

    function renderStocks(sectorKey) {
      const s = DATA.find(x => x.key === sectorKey);
      if (!s) return;

      backBtn.style.display = "block";

      const weights = s.stocks.map((_,i)=> (s.stocks.length - i));
      const radii = scaleSizes(weights, 18, 64);
      const pts = normalize(packCircles(radii), 170, 120);

      const seriesData = s.stocks.map((x,i) => ({
        name: x.t,
        value: [pts[i][0], pts[i][1], weights[i]],
        symbolSize: radii[i],
        itemStyle: {
          color: s.color,
          opacity: 1,
          borderWidth: 1.1,
          borderColor: "rgba(0,0,0,.18)",
          shadowBlur: 0
        }
      }));

      chart.setOption({
        ...baseOption(),
        series: [{
          type: "scatter",
          symbol: "circle",
          data: seriesData,
          label: { ...LABEL, fontSize: 11 },
          labelLayout: { hideOverlap: true },
          emphasis: {
            scale: true,
            focus: "self",
            itemStyle: { borderWidth: 2, borderColor: "rgba(0,0,0,.28)", shadowBlur: 0 }
          }
        }]
      }, true);
    }

    backBtn.addEventListener("click", renderSectors);

    chart.off("click");
    chart.on("click", (params) => {
      const k = params?.data?.sectorKey;
      if (k) renderStocks(k);
    });

    renderSectors();
  })();
  </script>
</body>
</html>
